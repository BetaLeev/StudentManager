<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>资讯list_module</title>
    <style>
        body{
            padding: 0px;
            margin: 0px;
        }
        #zixunBox{
            width:99%;
            height:auto;
        }
        .zixunItem{
            width:99%;
            height: 92.942px;
            margin:0 auto;
            border-bottom: 2px solid #e7e4e4;
            margin-top:4px;
        }
        .zixunItem .img_box{
            width:44%;
            height: 85px;
            padding:0;
            float: left;
            left: 5px;
        }
        .img_box img{
            width:100%;
            height: 100%;
            display: block;
            object-fit: cover;
            border-radius: inherit;
            transition: inherit;
            border: 1px solid black;
        }
        .zixunItem .right{
            width:53%;
            float: right;
            height: 85px;
        }
        .zixunItem .right p{
            height: 40px;
            font-size: 14px;
            text-align: justify;
            margin-top:5px;
            font-weight: normal;
            font-style: normal;
            color: #101010;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .zixunItem .right .zixunItemBottom .zixunType{
            color: rgb(255, 152, 0);
            font-size: 12px;
            line-height: 17px;
            font-weight: normal;
            font-style: normal;
            margin-right: 10px;
        }
        .zixunItem .right .zixunItemBottom .publishTime{color: rgba(16, 16, 16, 0.82);
        font-size: 14px;
        line-height: 20px;
        font-weight: normal;
        font-style: normal;
        }
        .foot{
            width:100%;
            height:auto;
            position: absolute;
            bottom: 5px;
            text-align: center;
        }
        .foot span{
            width:20px;
            font-size: 14px;
            height: auto;
            text-align: center;
            margin: 0 auto;
            color:#a4a2a2;
        }
    </style>
</head>
<body>
    <div id="zixunBox">
    </div>
    <div class="foot">
        <span id="foot_text"></span>
    </div>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript">
    var html_box = document.getElementById("zixunBox");
    var foot_text = document.getElementById("foot_text");
    var UILoading;
    var flowerid;
    function loaddata(){
        UILoading = api.require('UILoading');
        UILoading.flower({
            center: {
                x: api.winWidth/2,
                y: api.winHeight/2
            },
            mask:"rgba(0,0,0,0.1)",
            size: 30,
            fixed: true
            }, function(ret) {
                flowerid = ret.id
            });
        api.ajax({
             url: api.pageParam.name,
             method: 'get'
         }, function(ret, err){
            UILoading.closeFlower ({
                id: flowerid
            });
            if( ret ){
                 var json_data = ret.data;
                 var data_html = "";
                 if(json_data.length!=0){
                    for(var i=0;i<json_data.length;i++){
                    data_html+="<div class='zixunItem' tapmode onclick=fngodetailpage('"+json_data[i]['url']+"','"+json_data[i]['title']+"')>\
            <div class='img_box'>\
                <img src='"+json_data[i]['avar_pic']+"' />\
            </div>\
            <div class='right'>\
                <p class='zixunItemTitle'>"+json_data[i]['title']+"</p>\
                <div class='zixunItemBottom'>\
                    <span class='zixunType'>"+json_data[i]['type']+"</span>\
                    <span class='publishTime'>"+json_data[i]['publish_time']+"</span>\
                </div>\
            </div>\
        </div>"
                 }
                 html_box.innerHTML = data_html;
                 foot_text.innerHTML = "没有更多了";
                 }else{
                    foot_text.innerHTML = "没有数据";
                 }
            }else{
                alert(err.msg)
                foot_text.innerHTML = err.msg;
            }
            api.refreshHeaderLoadDone();
        });
    }
    apiready = function(){
        loaddata();
        api.setRefreshHeaderInfo({
        visible: true,
        loadingImg: '../../image/navtabbar/loading_more.gif',
        bgColor: '#fff',
        textColor: '#cdcdcd',
        textDown: '下拉刷新...',
        textUp: '松开刷新...',
        showTime: true
    }, function(ret, err){
        loaddata();
    });
    };
    function fngodetailpage(obj_url,top_title){
        api.openWin({
            name: 'zixun_news_content_module',
            url: '../../html/detail_zixun_news.html',
            pageParam: {
                name: obj_url,
                title:top_title
            },
            bounces: true,
            bgColor: '#ffffff',
            vScrollBarEnabled: true,
            hScrollBarEnabled: true
        });
    };
</script>
</html>